lua script allows atomic operation (like transactions) 